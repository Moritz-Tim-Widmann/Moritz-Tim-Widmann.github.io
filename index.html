<!DOCTYPE html>
<html lang="en">
<head>
    <link href="css/index.css" rel="stylesheet">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IMS Portal</title>
</head>
<body>
    <h1>Willkommen zum inoffiziellen IMS Portal</h1>
    <h2>Die website ist noch in arbeit. Bitte Probleme/Vorschläge auf <a href="https://github.com/Moritz-Tim-Widmann/infms.me/issues/new">GitHub</a></h2>

    <div><a href="https://imsnoten.ch/">Inoffizielles Notenportal</a></div>
    <div><a href="/Stundenplan/">Stundenplan</a></div>
    <div><a href="https://gist.github.com/Moritz-Tim-Widmann/385b86a6630fe6dbc4b661dc01c35ed3">Kalender</a></div>
    <div id="jsOut"></div>
    <script type="text/javascript">
        /** Returns this year, month, day with the specified hours and minutes. */
        function time(hours, minutes) {
            return new Date().setHours(hours, minutes, 0, 0)
        }

        /** An array of arrays of dates, representing the start and end of each break */
        const breaks = [
            time(08,45),
            time(09,40),
            time(10,35),
            time(11,35),
            time(12,30),
            time(13,20),
            time(14,10),
            time(15,05),
            time(16,00),
            time(16,55)
        ]

        function niceDate(date){
            let d = new Date(date)
            return d.getDate()+"."+d.getMonth()+"."+d.getFullYear()+" "+d.getHours()+":"+d.getMinutes()+":"+d.getSeconds()
        }
        
        /** gets you the next break.
         * @author https://stackoverflow.com/users/1048572/bergi
        */
        function getNextBreak(breaks) {
            breaks.sort(function(a, b) {
                let distancea = Math.abs(new Date() - a);
                let distanceb = Math.abs(new Date() - b);
                return distancea - distanceb; // sort a before b when the distance is smaller
            });
            let nextDates = breaks.filter(function(d) {return d - new Date() > 0})
            return nextDates[0]
        }
        
        //stolen from w3schools
        x = setInterval(function(){
            let countDownDate = getNextBreak(breaks)
            console.log()
            console.log("next break:",niceDate(countDownDate))

            let now = new Date().getTime()
            let distance = new Date(countDownDate - now)

            let countDown = distance.getMinutes() + ":" + distance.getSeconds() + ":" + distance.getMilliseconds()
            document.getElementById("jsOut").innerHTML = "Nächste Pause in: "+countDown
            console.log("full countdown:", niceDate(distance))


        }, 20)


        
        

    </script>
    <div><a href="https://github.com/ims-informatikmittelschule-basel">IMS GitHub</div>
        
</body>
</html>